# Bitrix in docker

## Начало работы

1. Скопировать файл [.env.example](.env.example) в файл [.env](.env) - это будет локальный конфиг.
2. Создать сайт (см. ниже раздел руководства).
3. Запустить сервер:
   ```bash
   docker-compose up -d
   ```

## Добавление новой площадки (docker-compose)

1. Скопировать папку [bitrix-distr/](bitrix-distr/) в папку [sites/](sites/).
2. Переименовать новую папку в соответствии с продуктивным адресом проекта, например: `test.example.com`.
3. Открываем файл docker-compose.yml в новой папке и:
   1. Находим все вхождения подстроки "stub" и заменяем на имя проекта, при этом точки экранируем через дефисы, например: `test-example-com`. При этом в директивах volumes указываем с точками (так как это пути к папке на диске)
   2. Редактируем директиву Host(`${MAIN_HOST}`), указываем тут имя домена, для локального проекта, например, можно указать `example.local`.
   3. Для локального проекта редактируем файл hosts на машине, добавляем туда запись. На linux-подобных машинах для этого выполняем:
      ```bash
      sudo nano /etc/hosts
      ```
4. В файле [.env](.env) добавляем в переменную COMPOSE_FILE путь к нашему новому compose-файлу, например: `:sites/test.example.com/docker-compose.yml`.
5. Перезапустить сервер:
   ```bash
   docker-compose up -d
   ```
